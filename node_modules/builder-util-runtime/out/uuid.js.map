{"version":3,"file":"uuid.js","sourceRoot":"","sources":["../src/uuid.ts"],"names":[],"mappings":";;;;;;;;;AAAA,AAAO,AAAE,AAAU,AAAE,AAAW,AAAE,AAAM,AAAQ;;;;AAEhD,MAAM,AAAW,cACf,AAAkD;AAEpD,MAAM,AAAa,gBACjB,AAAmD;AAErD,AAA2C;AAC3C,MAAM,AAAU,aAAG,AAAW,6CAAC,AAAE,AAAC;AAClC,AAAU,WAAC,AAAC,AAAC,KAAG,AAAU,WAAC,AAAC,AAAC,KAAG,AAAI;AAEpC,AAA6D;AAC7D,MAAM,AAAI,OAAG,AAAW,6CAAC,AAAC,AAAC;AAC3B,IAAI,AAAQ,WAAG,CAAC,AAAI,KAAC,AAAC,AAAC,AAAG,KAAC,AAAI,KAAC,AAAC,AAAC,MAAI,AAAC,AAAC,AAAC,KAAG,AAAM;AAElD,AAAe;AACf,IAAI,AAAS,YAAG,AAAC;AACjB,IAAI,AAAS,YAAG,AAAC;AAEjB,AAA2B;AAC3B,MAAM,AAAQ,WAAQ,AAAE;AAExB,AAA2B;AAC3B,MAAM,AAAQ,WAAkB,AAAE;AAClC,AAAyB;AACzB,AAAG,AAAC,KAAC,IAAI,AAAC,IAAG,AAAC,GAAE,AAAC,IAAG,AAAG,KAAE,AAAC,AAAE,KAAE,AAAC;AAC3B,UAAM,AAAG,MAAG,CAAC,AAAC,IAAG,AAAK,AAAC,OAAC,AAAQ,SAAC,AAAE,AAAC,IAAC,AAAM,OAAC,AAAC,AAAC;AAC9C,AAAQ,aAAC,AAAG,AAAC,OAAG,AAAC;AACjB,AAAQ,aAAC,AAAC,AAAC,KAAG,AAAG,AACrB;AAAC;AAED,AAAa,AACb,AAAM;;AASJ,gBAAY,AAAqB;AAC/B,cAAM,AAAK,QAAG,AAAI,KAAC,AAAK,MAAC,AAAI,AAAC;AAC9B,AAAE,AAAC,YAAC,CAAC,AAAK,AAAC,OAAC,AAAC;AACX,kBAAM,IAAI,AAAK,MAAC,AAAY,AAAC,AAC/B;AAAC;AAED,AAAI,aAAC,AAAO,UAAG,AAAK,MAAC,AAAS;AAE9B,AAAE,AAAC,YAAC,AAAK,MAAC,AAAM,WAAK,AAAO,AAAC,SAAC,AAAC;AAC7B,AAAI,iBAAC,AAAK,QAAG,AAAc,AAC7B;AAAC,AACD,AAAI,eAAC,AAAC;AACJ,AAAI,iBAAC,AAAM,SAAG,AAAc,AAC9B;AAAC,AACH;AAAC;AAED,AAAM,WAAC,AAAE;AACP,AAAM,eAAC,AAAa,cAAC,AAAU,AAAC,AAClC;AAAC;AAED,AAAM,WAAC,AAAE,GAAC,AAAqB,MAAE,AAAiB;AAChD,AAAM,eAAC,AAAS,UAAC,AAAI,MAAE,AAAM,QAAE,AAAI,MAAE,AAAS,AAAC,AACjD;AAAC;AAED,AAAQ;AACN,AAAE,AAAC,YAAC,AAAI,KAAC,AAAK,SAAI,AAAI,AAAC,MAAC,AAAC;AACvB,AAAI,iBAAC,AAAK,QAAG,AAAS,UAAC,AAAI,KAAC,AAAM,AAAC,AACrC;AAAC;AACD,AAAM,eAAC,AAAI,KAAC,AAAK,AACnB;AAAC;AAED,AAAQ;AACN,AAAE,AAAC,YAAC,AAAI,KAAC,AAAM,UAAI,AAAI,AAAC,MAAC,AAAC;AACxB,AAAI,iBAAC,AAAM,SAAG,AAAI,KAAC,AAAK,MAAC,AAAI,KAAC,AAAO,AAAC,AACxC;AAAC;AACD,AAAM,eAAC,AAAM,OAAC,AAAI,KAAC,AAAI,KAAC,AAAM,AAAC,AACjC;AAAC;AAED,AAAO;AACL,AAAM,AAAC,wBAAS,AAAI,KAAC,AAAO,WAAI,AAAI,KAAC,AAAQ,AAAE,UAAE,AACnD;AAAC;AAED,AAAM,WAAC,AAAK,MAAC,AAAqB,MAAE,SAAiB,AAAC;AACpD,AAAE,AAAC,YAAC,OAAO,AAAI,SAAK,AAAQ,AAAC,UAAC,AAAC;AAC7B,AAAI,mBAAG,AAAI,KAAC,AAAW,AAAE;AAEzB,AAAE,AAAC,gBAAC,CAAC,AAAiD,kDAAC,AAAI,KAAC,AAAI,AAAC,AAAC,OAAC,AAAC;AAClE,AAAM,uBAAC,AAAK,AACd;AAAC;AAED,AAAE,AAAC,gBAAC,AAAI,SAAK,AAAsC,AAAC,wCAAC,AAAC;AACpD,AAAM,uBAAC,EAAC,AAAO,SAAE,AAAS,WAAE,AAAO,SAAE,AAAK,OAAE,AAAM,QAAE,AAAO,AAAC,AAC9D;AAAC;AAED,AAAM;AACJ,AAAO,yBAAE,CAAC,AAAQ,SAAC,AAAI,KAAC,AAAE,AAAC,MAAG,AAAI,KAAC,AAAE,AAAC,AAAC,OAAG,AAAI,AAAC,SAAI,AAAC;AACpD,AAAO,yBAAE,AAAU,WAAC,CAAC,AAAQ,SAAC,AAAI,KAAC,AAAE,AAAC,MAAG,AAAI,KAAC,AAAE,AAAC,AAAC,OAAG,AAAI,AAAC,SAAI,AAAC,AAAC;AAChE,AAAM,wBAAE,AAAO,AAChB,AACH;AALS;AAKR;AAED,AAAE,AAAC,YAAC,AAAM,OAAC,AAAQ,SAAC,AAAI,AAAC,AAAC,OAAC,AAAC;AAC1B,AAAE,AAAC,gBAAC,AAAI,KAAC,AAAM,SAAG,AAAM,SAAG,AAAE,AAAC,IAAC,AAAC;AAC9B,AAAM,uBAAC,AAAK,AACd;AAAC;AAED,gBAAI,AAAC,IAAG,AAAC;AACT,AAAG,AAAC,AAAC,mBAAE,AAAC,IAAG,AAAE,IAAE,AAAC,AAAE,KAAE,AAAC;AACnB,AAAE,AAAC,oBAAC,AAAI,KAAC,AAAM,SAAG,AAAC,AAAC,OAAK,AAAC,AAAC,GAAC,AAAC;AAC3B,AAAK,AACP;AAAC,AACH;AAAC;AACD,AAAE,AAAC,gBAAC,AAAC,MAAK,AAAE,AAAC,IAAC,AAAC;AACb,AAAM,uBAAC,EAAC,AAAO,SAAE,AAAS,WAAE,AAAO,SAAE,AAAK,OAAE,AAAM,QAAE,AAAQ,AAAC,AAC/D;AAAC;AAED,AAAM;AACJ,AAAO,yBAAE,CAAC,AAAI,KAAC,AAAM,SAAG,AAAC,AAAC,KAAG,AAAI,AAAC,SAAI,AAAC;AACvC,AAAO,yBAAE,AAAU,WAAC,CAAC,AAAI,KAAC,AAAM,SAAG,AAAC,AAAC,KAAG,AAAI,AAAC,SAAI,AAAC,AAAC;AACnD,AAAM,wBAAE,AAAQ,AACjB,AACH;AALS;AAKR;AAED,cAAM,IAAI,AAAK,MAAC,AAAsB,AAAC,AACzC;AAAC;AAED,AAAsC;AACtC,AAAM,WAAC,AAAK,MAAC,AAAa;AACxB,cAAM,AAAM,SAAG,AAAM,OAAC,AAAW,YAAC,AAAE,AAAC;AACrC,YAAI,AAAC,IAAG,AAAC;AACT,AAAG,AAAC,aAAC,IAAI,AAAC,IAAG,AAAC,GAAE,AAAC,IAAG,AAAE,IAAE,AAAC,AAAE,KAAE,AAAC;AAC5B,AAAM,mBAAC,AAAC,AAAC,KAAG,AAAQ,SAAC,AAAK,MAAC,AAAC,AAAE,AAAC,OAAG,AAAK,MAAC,AAAC,AAAE,AAAC,AAAC;AAC7C,AAAE,AAAC,gBAAC,AAAC,MAAK,AAAC,KAAI,AAAC,MAAK,AAAC,KAAI,AAAC,MAAK,AAAC,KAAI,AAAC,MAAK,AAAC,AAAC,GAAC,AAAC;AAC7C,AAAC,qBAAI,AAAC,AACR;AAAC,AACH;AAAC;AACD,AAAM,eAAC,AAAM,AACf;AAAC;;qBArGD,AAA0B;;AACV,KAAG,MAAG,IAAI,AAAI,KAAC,AAAsC,AAAC;AACtD,KAAG,MAAG,AAAI,KAAC,AAAK,MAAC,AAAsC,AAAC;AAsG1E,AAAqC;AACrC,oBAAoB,AAAY;AAC5B,AAAM,AAAC,YAAC,AAAI,AAAC,AAAC,AAAC;AACX,aAAK,AAAC,AAAC;AAAC,aAAK,AAAC,AAAC;AAAC,aAAK,AAAC;AAClB,AAAM,mBAAC,AAAK;AAChB,aAAK,AAAC,AAAC;AAAC,aAAK,AAAC;AACV,AAAM,mBAAC,AAAS;AACpB,aAAK,AAAC;AACF,AAAM,mBAAC,AAAW;AACtB;AACI,AAAM,mBAAC,AAAQ,AACvB,AAAC,AACL;;AAAC;AAUD,IAAK,AAEJ;AAFD,WAAK,AAAY;AACf,8CAAK;AAAE,+CAAM;AAAE,+CAAM,AACvB;AAAC,GAFI,AAAY,iBAAZ,AAAY,eAEhB;AAED,AAAK;AACL,uBAAuB,AAAc,QAAE,WAAyB,AAAY,aAAC,AAAK;AAChF,QAAI,AAAK,QAAG,AAAI,KAAC,AAAG,AAAE;AACtB,QAAI,AAAK,QAAG,AAAS,YAAG,AAAC;AACzB,UAAM,AAAK,QAAI,AAAK,QAAG,AAAS,AAAC,SAAnB,GAAsB,CAAC,AAAK,QAAG,AAAS,AAAC,aAAG,AAAK;AAE/D,AAAE,AAAC,QAAC,AAAK,QAAG,AAAC,AAAC,GAAC,AAAC;AACd,AAAQ,mBAAI,AAAQ,WAAG,AAAC,AAAC,CAAd,GAAiB,AAAM;AAClC,AAAK,gBAAG,AAAC,AACX;AAAC,AACD,AAAI,eAAK,AAAK,QAAG,AAAS,AAAC,WAAC,AAAC;AAC3B,AAAK,gBAAG,AAAC,AACX;AAAC,AACD,AAAI,KAHC,AAAE,AAAC,MAGH,AAAE,AAAC,IAAC,AAAK,SAAI,AAAK,AAAC,OAAC,AAAC;AACxB,AAAM,eAAC,AAAa,AACtB;AAAC;AAED,AAAS,gBAAG,AAAK;AACjB,AAAS,gBAAG,AAAK;AAEjB,AAA+D;AAC/D,AAAK,aAAI,AAAc;AAEvB,UAAM,AAAM,SAAG,AAAM,OAAC,AAAW,YAAC,AAAE,AAAC;AACrC,UAAM,AAAU,aAAG,AAAQ;AAC3B,UAAM,AAAO,UAAG,CAAC,CAAC,AAAK,QAAG,AAAS,AAAC,aAAG,AAAK,QAAG,AAAK,AAAC,SAAG,AAAW;AACnE,UAAM,AAAQ,WAAI,AAAK,QAAG,AAAW,cAAG,AAAK,AAAC,KAA7B,GAAgC,AAAS;AAE1D,AAAM,WAAC,AAAC,AAAC,KAAG,AAAO,YAAK,AAAE,KAAG,AAAI;AACjC,AAAM,WAAC,AAAC,AAAC,KAAG,AAAO,YAAK,AAAE,KAAG,AAAI;AACjC,AAAM,WAAC,AAAC,AAAC,KAAG,AAAO,YAAK,AAAC,IAAG,AAAI;AAChC,AAAM,WAAC,AAAC,AAAC,KAAG,AAAO,UAAG,AAAI;AAE1B,AAAM,WAAC,AAAC,AAAC,KAAG,AAAQ,aAAK,AAAC,IAAG,AAAI;AACjC,AAAM,WAAC,AAAC,AAAC,KAAG,AAAQ,WAAG,AAAI;AAE3B,AAAM,WAAC,AAAC,AAAC,KAAI,AAAQ,aAAK,AAAE,KAAG,AAAI,AAAC,IAAxB,GAA2B,AAAI;AAC3C,AAAM,WAAC,AAAC,AAAC,KAAI,AAAQ,aAAK,AAAE,KAAG,AAAI,AAAC,IAAxB,GAA2B,AAAI;AAE3C,AAAM,WAAC,AAAC,AAAC,KAAG,AAAU,eAAK,AAAC;AAC5B,AAAM,WAAC,AAAC,AAAC,KAAG,AAAU,aAAG,AAAI;AAE7B,QAAI,AAAW;AACf,AAAM,AAAC,YAAC,AAAQ,AAAC,AAAC,AAAC;AACjB,aAAK,AAAY,aAAC,AAAM;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,qBAAG,AAAM;AACf,AAAK;AACP,aAAK,AAAY,aAAC,AAAM;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,mBAAC,AAAE,AAAC,MAAG,AAAM,OAAC,AAAC,AAAC;AACtB,AAAM,qBAAG,IAAI,AAAI,KAAC,AAAM,AAAC;AACzB,AAAK;AACP;AACE,AAAM,qBAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAChD,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MAC/C,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MAC/C,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MAC/C,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MAC/C,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MACzC,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MACzC,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC;AAC3C,AAAK,AACT,AAAC;;AACD,AAAM,WAAC,AAAM,AACf;AAAC;AAED,AAAU;AACV,mBAAmB,AAAqB,MAAE,AAAkB,YAAE,AAAe,SAAE,AAAiB,WAAE,WAAyB,AAAY,aAAC,AAAK;AAC3I,UAAM,AAAI,OAAG,AAAU,4CAAC,AAAU,AAAC;AAEnC,UAAM,AAAgB,mBAAG,OAAO,AAAI,SAAK,AAAQ;AACjD,AAAE,AAAC,QAAC,AAAgB,oBAAI,CAAC,AAAM,OAAC,AAAQ,SAAC,AAAI,AAAC,AAAC,OAAC,AAAC;AAC/C,cAAM,IAAI,AAAK,MAAC,AAAW,AAAC,AAC9B;AAAC;AAED,AAAI,SAAC,AAAM,OAAC,AAAS,AAAC;AACtB,AAAI,SAAC,AAAM,OAAC,AAAI,MAAE,AAAgB,AAAC,AAAC,mBAAC,AAAQ,AAAC,AAAC,WAAC,AAAM,AAAC;AAEvD,UAAM,AAAM,SAAG,AAAI,KAAC,AAAM,AAAE;AAC5B,QAAI,AAAW;AACf,AAAM,AAAC,YAAC,AAAQ,AAAC,AAAC,AAAC;AACjB,aAAK,AAAY,aAAC,AAAM;AACtB,AAAM,mBAAC,AAAC,AAAC,KAAI,AAAM,OAAC,AAAC,AAAC,KAAG,AAAI,AAAC,IAAlB,GAAqB,AAAO;AACxC,AAAM,mBAAC,AAAC,AAAC,KAAI,AAAM,OAAC,AAAC,AAAC,KAAG,AAAI,AAAC,IAAlB,GAAqB,AAAI;AACrC,AAAM,qBAAG,AAAM;AACf,AAAK;AACP,aAAK,AAAY,aAAC,AAAM;AACtB,AAAM,mBAAC,AAAC,AAAC,KAAI,AAAM,OAAC,AAAC,AAAC,KAAG,AAAI,AAAC,IAAlB,GAAqB,AAAO;AACxC,AAAM,mBAAC,AAAC,AAAC,KAAI,AAAM,OAAC,AAAC,AAAC,KAAG,AAAI,AAAC,IAAlB,GAAqB,AAAI;AACrC,AAAM,qBAAG,IAAI,AAAI,KAAC,AAAM,AAAC;AACzB,AAAK;AACP;AACE,AAAM,qBAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAChD,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MAC/C,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MAC/C,AAAQ,SAAE,AAAM,OAAC,AAAC,AAAC,KAAG,AAAI,AAAC,IAAlB,GAAqB,AAAO,AAAC,WACtC,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MACzB,AAAQ,SAAE,AAAM,OAAC,AAAC,AAAC,KAAG,AAAI,AAAC,IAAlB,GAAqB,AAAI,AAAC,QACnC,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MACzB,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC,OAAG,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC,OAC3C,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC,OAAG,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC,OAC3C,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC,OAAG,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC;AAC7C,AAAK,AACT,AAAC;;AACD,AAAM,WAAC,AAAM,AACf;AAAC;AAED,mBAAmB,AAAc;AAC/B,AAAM,WAAC,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAC9C,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MAC/C,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MAC/C,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MAC/C,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAQ,SAAC,AAAM,OAAC,AAAC,AAAC,AAAC,MAAG,AAAG,MAC/C,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC,OAAG,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC,OAC3C,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC,OAAG,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC,OAC3C,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC,OAAG,AAAQ,SAAC,AAAM,OAAC,AAAE,AAAC,AAAC,AAC/C;AAAC;AAED,AAAqC,AACrC,AAAM;AAAC,MAAM,AAAG,oBAAG,IAAI,AAAI,KAAC,AAAsC,AAAC;AAEnE,AAAuB;AAEvB,AAA+B;AAE/B,AAA0C;AAC1C,AAAuD;AACvD,AAAI","sourcesContent":["import { createHash, randomBytes } from \"crypto\"\n\nconst invalidName =\n  \"options.name must be either a string or a Buffer\"\n\nconst moreThan10000 =\n  \"can not generate more than 10000 UUIDs per second\"\n\n// Node ID according to rfc4122#section-4.5\nconst randomHost = randomBytes(16)\nrandomHost[0] = randomHost[0] | 0x01\n\n// randomize clockSeq initially, as per rfc4122#section-4.1.5\nconst seed = randomBytes(2)\nlet clockSeq = (seed[0] | (seed[1] << 8)) & 0x3fff\n\n// clock values\nlet lastMTime = 0\nlet lastNTime = 0\n\n// lookup table hex to byte\nconst hex2byte: any = {}\n\n// lookup table byte to hex\nconst byte2hex: Array<string> = []\n// populate lookup tables\nfor (let i = 0; i < 256; i++) {\n    const hex = (i + 0x100).toString(16).substr(1)\n    hex2byte[hex] = i\n    byte2hex[i] = hex\n}\n\n// UUID class\nexport class UUID {\n  private ascii: string | null\n  private binary: Buffer\n  private version: number\n\n  // from rfc4122#appendix-C\n  static readonly URL = new UUID(\"6ba7b811-9dad-11d1-80b4-00c04fd430c8\")\n  static readonly OID = UUID.parse(\"6ba7b812-9dad-11d1-80b4-00c04fd430c8\")\n\n  constructor(uuid: Buffer | string) {\n    const check = UUID.check(uuid)\n    if (!check) {\n      throw new Error(\"not a UUID\")\n    }\n\n    this.version = check.version!!\n\n    if (check.format === \"ascii\") {\n      this.ascii = uuid as string\n    }\n    else {\n      this.binary = uuid as Buffer\n    }\n  }\n\n  static v1() {\n    return uuidTimeBased(randomHost)\n  }\n\n  static v5(name: string | Buffer, namespace: Buffer) {\n    return uuidNamed(name, \"sha1\", 0x50, namespace)\n  }\n\n  toString() {\n    if (this.ascii == null) {\n      this.ascii = stringify(this.binary)\n    }\n    return this.ascii\n  }\n\n  toBuffer() {\n    if (this.binary == null) {\n      this.binary = UUID.parse(this.ascii!!)\n    }\n    return Buffer.from(this.binary)\n  }\n\n  inspect() {\n    return `UUID v${this.version} ${this.toString()}`\n  }\n\n  static check(uuid: Buffer | string, offset: number = 0) {\n    if (typeof uuid === \"string\") {\n      uuid = uuid.toLowerCase()\n\n      if (!/^[a-f0-9]{8}(\\-[a-f0-9]{4}){3}\\-([a-f0-9]{12})$/.test(uuid)) {\n        return false\n      }\n\n      if (uuid === \"00000000-0000-0000-0000-000000000000\") {\n        return {version: undefined, variant: \"nil\", format: \"ascii\"}\n      }\n\n      return {\n        version: (hex2byte[uuid[14] + uuid[15]] & 0xf0) >> 4,\n        variant: getVariant((hex2byte[uuid[19] + uuid[20]] & 0xe0) >> 5),\n        format: \"ascii\"\n      }\n    }\n\n    if (Buffer.isBuffer(uuid)) {\n      if (uuid.length < offset + 16) {\n        return false\n      }\n\n      let i = 0\n      for (; i < 16; i++) {\n        if (uuid[offset + i] !== 0) {\n          break\n        }\n      }\n      if (i === 16) {\n        return {version: undefined, variant: \"nil\", format: \"binary\"}\n      }\n\n      return {\n        version: (uuid[offset + 6] & 0xf0) >> 4,\n        variant: getVariant((uuid[offset + 8] & 0xe0) >> 5),\n        format: \"binary\"\n      }\n    }\n\n    throw new Error(\"Unknown type of uuid\")\n  }\n\n  // read stringified uuid into a Buffer\n  static parse(input: string) {\n    const buffer = Buffer.allocUnsafe(16)\n    let j = 0\n    for (let i = 0; i < 16; i++) {\n      buffer[i] = hex2byte[input[j++] + input[j++]]\n      if (i === 3 || i === 5 || i === 7 || i === 9) {\n        j += 1\n      }\n    }\n    return buffer\n  }\n}\n\n// according to rfc4122#section-4.1.1\nfunction getVariant(bits: number) {\n    switch (bits) {\n        case 0: case 1: case 3:\n            return \"ncs\"\n        case 4: case 5:\n            return \"rfc4122\"\n        case 6:\n            return \"microsoft\"\n        default:\n            return \"future\"\n    }\n}\n\nexport interface UuidOptions {\n  encoding?: string\n\n  name?: string\n\n  namespace?: string | UUID | Buffer\n}\n\nenum UuidEncoding {\n  ASCII, BINARY, OBJECT\n}\n\n// v1\nfunction uuidTimeBased(nodeId: Buffer, encoding: UuidEncoding = UuidEncoding.ASCII) {\n  let mTime = Date.now()\n  let nTime = lastNTime + 1\n  const delta = (mTime - lastMTime) + (nTime - lastNTime) / 10000\n\n  if (delta < 0) {\n    clockSeq = (clockSeq + 1) & 0x3fff\n    nTime = 0\n  }\n  else if (mTime > lastMTime) {\n    nTime = 0\n  }\n  else if (nTime >= 10000) {\n    return moreThan10000\n  }\n\n  lastMTime = mTime\n  lastNTime = nTime\n\n  // unix timestamp to gregorian epoch as per rfc4122#section-4.5\n  mTime += 12219292800000\n\n  const buffer = Buffer.allocUnsafe(16)\n  const myClockSeq = clockSeq\n  const timeLow = ((mTime & 0xfffffff) * 10000 + nTime) % 0x100000000\n  const timeHigh = (mTime / 0x100000000 * 10000) & 0xfffffff\n\n  buffer[0] = timeLow >>> 24 & 0xff\n  buffer[1] = timeLow >>> 16 & 0xff\n  buffer[2] = timeLow >>> 8 & 0xff\n  buffer[3] = timeLow & 0xff\n\n  buffer[4] = timeHigh >>> 8 & 0xff\n  buffer[5] = timeHigh & 0xff\n\n  buffer[6] = (timeHigh >>> 24 & 0x0f) | 0x10\n  buffer[7] = (timeHigh >>> 16 & 0x3f) | 0x80\n\n  buffer[8] = myClockSeq >>> 8\n  buffer[9] = myClockSeq & 0xff\n\n  let result: any\n  switch (encoding) {\n    case UuidEncoding.BINARY:\n      buffer[10] = nodeId[0]\n      buffer[11] = nodeId[1]\n      buffer[12] = nodeId[2]\n      buffer[13] = nodeId[3]\n      buffer[14] = nodeId[4]\n      buffer[15] = nodeId[5]\n      result = buffer\n      break\n    case UuidEncoding.OBJECT:\n      buffer[10] = nodeId[0]\n      buffer[11] = nodeId[1]\n      buffer[12] = nodeId[2]\n      buffer[13] = nodeId[3]\n      buffer[14] = nodeId[4]\n      buffer[15] = nodeId[5]\n      result = new UUID(buffer)\n      break\n    default:\n      result = byte2hex[buffer[0]] + byte2hex[buffer[1]] +\n        byte2hex[buffer[2]] + byte2hex[buffer[3]] + \"-\" +\n        byte2hex[buffer[4]] + byte2hex[buffer[5]] + \"-\" +\n        byte2hex[buffer[6]] + byte2hex[buffer[7]] + \"-\" +\n        byte2hex[buffer[8]] + byte2hex[buffer[9]] + \"-\" +\n        byte2hex[nodeId[0]] + byte2hex[nodeId[1]] +\n        byte2hex[nodeId[2]] + byte2hex[nodeId[3]] +\n        byte2hex[nodeId[4]] + byte2hex[nodeId[5]]\n      break\n  }\n  return result\n}\n\n// v3 + v5\nfunction uuidNamed(name: string | Buffer, hashMethod: string, version: number, namespace: Buffer, encoding: UuidEncoding = UuidEncoding.ASCII) {\n  const hash = createHash(hashMethod)\n\n  const nameIsNotAString = typeof name !== \"string\"\n  if (nameIsNotAString && !Buffer.isBuffer(name)) {\n    throw new Error(invalidName)\n  }\n\n  hash.update(namespace)\n  hash.update(name, nameIsNotAString ? \"latin1\" : \"utf8\")\n\n  const buffer = hash.digest()\n  let result: any\n  switch (encoding) {\n    case UuidEncoding.BINARY:\n      buffer[6] = (buffer[6] & 0x0f) | version\n      buffer[8] = (buffer[8] & 0x3f) | 0x80\n      result = buffer\n      break\n    case UuidEncoding.OBJECT:\n      buffer[6] = (buffer[6] & 0x0f) | version\n      buffer[8] = (buffer[8] & 0x3f) | 0x80\n      result = new UUID(buffer)\n      break\n    default:\n      result = byte2hex[buffer[0]] + byte2hex[buffer[1]] +\n        byte2hex[buffer[2]] + byte2hex[buffer[3]] + \"-\" +\n        byte2hex[buffer[4]] + byte2hex[buffer[5]] + \"-\" +\n        byte2hex[(buffer[6] & 0x0f) | version] +\n        byte2hex[buffer[7]] + \"-\" +\n        byte2hex[(buffer[8] & 0x3f) | 0x80] +\n        byte2hex[buffer[9]] + \"-\" +\n        byte2hex[buffer[10]] + byte2hex[buffer[11]] +\n        byte2hex[buffer[12]] + byte2hex[buffer[13]] +\n        byte2hex[buffer[14]] + byte2hex[buffer[15]]\n      break\n  }\n  return result\n}\n\nfunction stringify(buffer: Buffer) {\n  return byte2hex[buffer[0]] + byte2hex[buffer[1]] +\n    byte2hex[buffer[2]] + byte2hex[buffer[3]] + \"-\" +\n    byte2hex[buffer[4]] + byte2hex[buffer[5]] + \"-\" +\n    byte2hex[buffer[6]] + byte2hex[buffer[7]] + \"-\" +\n    byte2hex[buffer[8]] + byte2hex[buffer[9]] + \"-\" +\n    byte2hex[buffer[10]] + byte2hex[buffer[11]] +\n    byte2hex[buffer[12]] + byte2hex[buffer[13]] +\n    byte2hex[buffer[14]] + byte2hex[buffer[15]]\n}\n\n// according to rfc4122#section-4.1.7\nexport const nil = new UUID(\"00000000-0000-0000-0000-000000000000\")\n\n// UUID.v4 = uuidRandom\n\n// UUID.v4fast = uuidRandomFast\n\n// UUID.v3 = function(options, callback) {\n//     return uuidNamed(\"md5\", 0x30, options, callback)\n// }"]}
